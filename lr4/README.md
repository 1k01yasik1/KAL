# Лабораторная работа №4. Программирование параллельных потоков

Репозиторий содержит код и отчёт лабораторной работы, посвящённой сравнению
последовательного и параллельного алгоритмов решения задачи коммивояжёра на
основе муравьиного алгоритма.

## Структура каталога

```
lr4/
├── code/          # исходный код, тесты и входные данные
├── report/        # исходники LaTeX-отчёта
├── makefile       # сборка тестов, генерация отчёта
└── README.md
```

## Быстрый старт

```bash
cd lr4
make                          # запускает модульные тесты
./code/tests/test_main.out    # выполнение тестов напрямую
./code/app --graph path/to/graph.dot --threads=4
```

Основная программа принимает следующие параметры:

- `--graph=path` — путь к входному графу в формате Graphviz DOT;
- `--ants=N` — количество муравьёв в популяции;
- `--iterations=N` — число итераций;
- `--threads=N` — количество рабочих потоков для параллельной версии;
- `--only-seq` / `--only-par` — запуск только последовательной или параллельной версии;
- `--print-paths=false` — скрыть вывод найденных маршрутов.

В каталоге `code/data` размещён пример входного графа `sample.dot`.

## Автоматический бенчмарк

Для запуска серии измерений на графах размерности 3000–7000 с сохранением
результатов в CSV подготовлен скрипт `run_benchmark.sh`:

```bash
cd lr4
./run_benchmark.sh --graph-dir=code/data/benchmark --output=benchmark_results.csv
```

Скрипт автоматически соберёт бинарник `code/benchmark` и пробросит все
переданные параметры в программу бенчмарка. При необходимости можно указать
собственный каталог с графами (`--graph-dir`) или изменить число прогонов и
прочие настройки (например, `--runs=100`).

## Генерация разреженных графов Graphviz

Для экспериментов с крупными входами можно заранее сгенерировать набор
разреженных графов (3000–7000 вершин, степень вершины не превышает 15) при
помощи утилиты `generate_sparse_graphs.py`:

```bash
cd lr4
python3 generate_sparse_graphs.py \
  --output-dir=code/data/generated_graphs \
  --sizes=3000,3500,4000,4500,5000,5500,6000,6500,7000
```

Скрипт создаёт для каждой размерности отдельный файл `graph_<N>.gv` с
неполносвязным неориентированным графом. В каждом графе заранее зашит один
гамильтонов цикл, а все дополнительные рёбра подбираются случайным образом при
ограничении на максимальную степень вершины. Параметры генерации (диапазон
весов, максимальная степень, каталог назначения) можно переопределить флагами
командной строки.
